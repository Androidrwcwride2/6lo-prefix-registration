<?xml version="1.0" encoding="utf-8"?>
<!--DOCTYPE rfc SYSTEM "rfc2629-xhtml.ent"-->


<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc tocdepth="3"?>
<?rfc tocindent="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<?rfc authorship="yes"?>
<?rfc tocappendix="yes"?>
<rfc  xmlns:xi="http://www.w3.org/2001/XInclude" category="std" ipr="trust200902"
tocInclude="true" indexInclude="true" obsoletes=""  consensus="true"
submissionType="IETF" xml:lang="en" version="3"  updates="4861, 6550, 6553, 8505, 8928, 9010"
docName="draft-ietf-6lo-prefix-registration-02" >

<front>

   <title abbrev="Prefix Registration">IPv6 Neighbor Discovery Prefix Registration</title>

   <author initials='P' surname='Thubert' fullname='Pascal Thubert' role='editor'>
      <!-- <organization abbrev='Cisco Systems'>Cisco Systems, Inc</organization> -->
      <address>
         <postal>
            <city>Roquefort-les-Pins</city>
            <code>06330</code>
          <country>France</country>
         </postal>
         <email>pascal.thubert@gmail.com</email>
      </address>
   </author>

   <area>Internet</area>


   <workgroup>6lo</workgroup>

   <abstract>
   <t>
    This document updates IPv6 Neighbor Discovery [RFC4861] and the 6LoWPAN
    extensions [RFC8505][RFC8928] to enable a node that owns or is directly
    connected to a prefix to register that prefix to neighbor routers. The
    registration indicates that the registered prefix can be reached via the
    advertising node without a loop.
    The unicast prefix registration also provides a protocol-independent interface for
    the node to request neighbor router(s) to redistribute the prefix to
    the larger routing domain using their specific routing protocols.
    This document extends RPL [RFC6550][RFC6553][RFC9010] to enable the 6LR to
    inject  the registered prefix in RPL.
   </t>
   </abstract>
</front>

<middle>

<!-- **************************************************************** -->
<!-- **************************************************************** -->
<!-- **************************************************************** -->
<!-- **************************************************************** -->
<section anchor="introduction"> <name>Introduction</name>

<t>The design of Low Power and Lossy Networks (LLNs) is generally focused on
   saving energy, which is the most constrained resource of all. Other design
   constraints, such as a limited memory capacity, duty cycling of the LLN
   devices and low-power lossy transmissions, derive from that primary concern.
   The radio (both transmitting or simply listening) is a major energy drain
   and the LLN protocols must be adapted to allow the nodes to remain sleeping
   with the radio turned off at most times.
</t><t>
   The <xref target="RFC6550">"Routing Protocol for Low Power
   and Lossy Networks"</xref> (RPL) provides IPv6 <xref target="RFC8200"/>
   routing services within such constraints.
   To save signaling and routing state in constrained networks, the RPL routing
   is only performed along a Destination-Oriented Directed Acyclic Graph (DODAG)
   that is optimized to reach a Root node, as opposed to along the shortest path
   between 2 peers, whatever that would mean in each LLN.
</t><t>
   This trades the quality of peer-to-peer (P2P) paths for a vastly reduced
   amount of control traffic and routing state that would be required to
   operate an any-to-any shortest path protocol. Additionally,
   broken routes may be fixed lazily and on-demand, based on dataplane
   inconsistency discovery, which avoids wasting energy in the proactive repair
   of unused paths.
</t><t>
   The "IPv6 Neighbor Discovery (IPv6 ND) Protocol"
   <xref target="RFC4861"/> <xref target="RFC4862"/> was defined for serial
   links and shared transit media such as Ethernet at a time when broadcast
   was cheap on those media while memory for neighbor cache was expensive.
   It was thus designed as a reactive protocol that relies on caching and
   multicast operations for the Address Resolution (AR, aka Address Discovery or
   Address Lookup) and Duplicate Address Detection (DAD) of IPv6 unicast addresses.
   Those multicast operations typically impact every node on-link when at most
   one is really targeted, which is a waste of energy, and imply that all
   nodes are awake to hear the request, which is inconsistent with power
   saving (sleeping) modes.
</t><t>
   The <xref target="I-D.ietf-6man-ipv6-over-wireless">
   "Architecture and Framework for IPv6 over Non-Broadcast Access" (NBMA)</xref>
   introduces an evolution of IPv6 ND towards a proactive AR method also
   called Stateful Address Autoconfiguration (SFAAC). Because the IPv6 model for
   NBMA depends on a routing protocol to reach inside the Subnet, the
   IPv6 ND extension for NBMA is refered to as Subnet Neighbor Discovery (SND).
   SND is based on work done in the context of IoT, known as 6LoWPAN ND.

</t><t>
   The original 6LoWPAN ND, <xref target="RFC6775"> "Neighbor Discovery
   Optimizations for 6LoWPAN networks"</xref>, was introduced to avoid the
   excessive use of multicast messages and enable IPv6 ND for operations over
   energy-constrained nodes.
   <xref target="RFC6775"/> changes the classical IPv6 ND model to proactively
   establish the Neighbor Cache Entry (NCE) associated to the unicast address of
   a 6LoWPAN Node (6LN) in the a 6LoWPAN Router(s) (6LR) that serves it.
   To that effect, <xref target="RFC6775"/> defines a new Address Registration
   Option (ARO) that is  placed in unicast Neighbor Solicitation (NS) and
   Neighbor Advertisement (NA) messages between the 6LN and the 6LR.
</t><t>
   <xref target="RFC8505"> "Registration Extensions for 6LoWPAN Neighbor
   Discovery"</xref> updates <xref target="RFC6775"/> into a generic Address
   Registration mechanism that can be used to access services such as routing
   and ND proxy and introduces the Extended Address Registration Option (EARO)
   for that purpose. This provides a routing-agnostic interface for a host to
   request that the router injects a unicast IPv6 address in the local routing
   protocol and provide return reachability for that address.
</t><t>
   <xref target="I-D.ietf-6lo-multicast-registration">
   "IPv6 Neighbor Discovery Multicast Address Listener Subscription"</xref>
   updates <xref target="RFC8505"/> to enable a listener to subscribe an IPv6
    anycast or multicast address; the draft also extends <xref target="RFC9010"/>
    to enable the 6LR to inject the anycast and multicast addresses in RPL.
    Similarly, this specification extends <xref target="RFC8505"/> and
    <xref target="RFC9010"/> to add the capability for the 6LN to register unicast
    prefixes as opposed to addresses, and to signal in a protocol-independant
    fashion to the 6LR that it is expected to redistribute the prefixes in
    their specific routing protocols.
</t>


</section>	<!-- end section = "Introduction"  -->



<section> <name>Terminology</name>
  <section anchor="bcp"><name>Requirements Language</name>
  <t>

    The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
    "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
    "OPTIONAL" in this document are to be interpreted as described in BCP 14
    <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when,
    they appear in all capitals, as shown here.

  </t>

<t>
  In addition, the terms "Extends" and "Amends" are used as per
  <xref target="I-D.kuehlewind-update-tag" /> section 3.
</t>
  </section>	<!-- end section "Requirements Language" -->

  <section anchor="lo"><name>References</name>
    <t>
	This document uses terms and concepts that are discussed in:
    </t>
	<ul>
	<li> <xref target="RFC4861">"Neighbor Discovery for IP version 6"
		</xref> and
	    <xref target="RFC4862">"IPv6 Stateless address Autoconfiguration"
		</xref>,
    </li>
	<li> <xref target="RFC6775">Neighbor Discovery Optimization for Low-Power
		and Lossy Networks</xref>, as well as
    </li>
    <li>
	    <xref target="RFC8505">
		"Registration Extensions for 6LoWPAN Neighbor Discovery"</xref> and
	</li>
    <li>
	    <xref target="RFC9008">
		"Using RPI Option Type, Routing Header for Source Routes,
        and IPv6-in-IPv6 Encapsulation in the RPL Data Plane"</xref>.
	</li>
	</ul>
  </section> <!--	 end section "References" -->



<section anchor='acronyms' > <name>Acronyms</name>
    <t> This document uses the following abbreviations:
    </t>
       <dl spacing='compact'>
       <dt>6BBR:</dt><dd>Backbone Router </dd>
       <dt>6CIO</dt><dd> Capability Indication Option </dd>
       <dt>6LN:</dt><dd>(6LoWPAN) Node  </dd>
       <dt>6LR:</dt><dd>(6LoWPAN) Router </dd>
       <dt>AMC</dt><dd> Address Mapping Confirmation </dd>
       <dt>AMR</dt><dd> Address Mapping Request</dd>
       <dt>ARO:</dt><dd>address Registration Option</dd>
       <dt>DAC:</dt><dd>Duplicate address Confirmation (message)</dd>
       <dt>DAD:</dt><dd>Duplicate address Detection </dd>
       <dt>DAO</dt><dd> Destination Advertisement Object </dd>
       <dt>DAR:</dt><dd>Duplicate address Request (message)</dd>
       <dt>DIO</dt><dd> DODAG Information Object </dd>
       <dt>DODAG</dt><dd> Destination-Oriented Directed Acyclic Graph </dd>
       <dt>EDAC:</dt><dd>Extended Duplicate address Confirmation  </dd>
       <dt>EDAR:</dt><dd>Extended Duplicate address Request</dd>
       <dt>LLN:</dt><dd>Low-Power and Lossy Network </dd>
       <dt>LLA:</dt><dd>link-local address </dd>
       <dt>LoWPAN:</dt><dd>Low-Power WPAN </dd>
       <dt>MAC:</dt><dd>Medium Access Control</dd>
       <dt>MLSN:</dt><dd>Multi-link Subnet </dd>
       <dt>MLD:</dt><dd> multicast Listener Discovery </dd>
       <dt>MOP</dt><dd>  Mode of Operation </dd>
       <dt>NA:</dt><dd> Neighbor Advertisement (message)</dd>
       <dt>NBMA:</dt><dd> Non-Broadcast Multi-Access (full mesh)</dd>
       <dt>NCE:</dt><dd> Neighbor Cache Entry  </dd>
       <dt>ND:</dt><dd> Neighbor Discovery (protocol)</dd>
       <dt>NDP:</dt><dd> Neighbor Discovery Protocol </dd>
       <dt>NS:</dt><dd> Neighbor Solicitation (message) </dd>
       <dt>P2P:</dt><dd> Point-to-Point </dd>
       <dt>P2MP:</dt><dd> Point-to-Multipoint (partial mesh)</dd>
       <dt>ROVR</dt><dd> Registration Ownership Verifier, pronounced "rover" </dd>
       <dt>RPL:</dt><dd>IPv6 Routing Protocol for LLNs </dd>
       <dt>RA:</dt><dd> Router Advertisement (message) </dd>
       <dt>RS:</dt><dd> Router Solicitation (message) </dd>
       <dt>RTO</dt><dd> RPL Target Option </dd>
       <dt>TID</dt><dd> Transaction ID </dd>
       <dt>TIO</dt><dd> Transit Information Option </dd>
       <dt>SGP:</dt><dd> Subnet Gateway Protocol  </dd>
       <dt>SPL:</dt><dd> Subnet Prefix Length  </dd>
       <dt>ULP:</dt><dd> Upper-Layer Protocol  </dd>
       <dt>VLAN:</dt><dd>Virtual LAN </dd>
       <dt>VxLAN:</dt><dd>Virtual Extensible LAN</dd>
       <dt>VPN:</dt><dd>Virtual Private Network</dd>
       <dt>WAN:</dt><dd>Wide Area Network </dd>

       <dt>SND:</dt><dd>Subnet Neighbor Discovery (protocol)</dd>
       <dt>WLAN:</dt><dd>Wireless Local Area Network </dd>
       <dt>WPAN:</dt><dd>Wireless Personal Area Network </dd>
       </dl>

     </section><!-- Acronyms -->


  <section anchor="terms"><name>New terms</name>

    <t> This document introduces the following terms:</t>

       <dl newline="false" indent="7" spacing="compact" >

       <dt>Origin</dt><dd> The node that issued the prefix
       advertisement, either in the form of a NS(EARO) or as a DAO(TIO, RTO) </dd>
       <dt>Merge/merging</dt><dd> The action of receiving multiple anycast or
       multicast advertisements, either internally from self, in the form of
       a NS(EARO), or as a DAO(TIO, RTO), and generating a single DAO(TIO, RTO).
       The 6RPL router maintains a state per origin for each advertised address, and merges the advertisements for all subsriptions for the same
       address in a single advertisement.
       A RPL router that merges becomes the origin of the merged advertisement
       and uses its own values for the Path Sequence and ROVR fields.
       </dd>

       </dl>


  </section> <!--	 end section "New terms" -->

</section>	<!-- end section "Terminology" -->



<!-- **************************************************************** -->
<!-- **************************************************************** -->
<!-- **************************************************************** -->
<!-- **************************************************************** -->
<!-- **************************************************************** -->
<!-- **************************************************************** -->
<!-- **************************************************************** -->
<!-- **************************************************************** -->

<section anchor="overview"><name>Overview</name>
   <t>
   This specification inherits from <xref target="RFC6550"/>,
   <xref target="RFC8505"/>, and <xref target="RFC9010"/> to register prefixes as opposed to addresses. Unless specified otherwise therein,
   the behavior of the 6LBR that acts as RPL Root, of the intermediate routers
   down the RPL graph, of the 6LR that act as access routers and of the 6LNs
   that are the RPL-unaware destinations, is the same as for unicast addresses.
   In particular, forwarding a packet happens as specified in section 11 of
   <xref target="RFC6550"/>, including loop avoidance and detection, though in
   the case of multicast multiple copies might be generated.
   </t>
   <t><xref target="RFC8505"/> is a pre-requisite to this specification.
   A node that implements this MUST also implement <xref target="RFC8505"/>.
   This specification does not introduce a new option; it modifies
   existing options and updates the associated behaviors to enable the
   Registration for Multicast Addresses as an extension to
   <xref target="RFC8505"/>.
   </t>

<t>
   This specification updates the P field introduced in <xref target=
   "I-D.ietf-6lo-multicast-registration"/> for use in EARO, DAR, and RTO,
   with the new value of 3 to indicate the registration of a prefix, as
   detailed in <xref target="R8505E"/>.
   With this extension the 6LNs can now attract the traffic for a full
   prefix, using the P field value of 3 in the EARO to signal that the
   registration is for a prefix. Multiple 6LN may register the same
   prefix to the same 6LR or to different 6LRs.
</t><t>
   If the R flag is set in the registration of one or more 6LNs for the same
   prefix, the 6LR is requested to redistributes the prefix in other routing
   protocol (e.g., RPL), based on the longest registration lifetime across the
   active registrations for the prefix.
</t><t>
   This specification extends 6LoWPAN work, and it is certainly possible to
   leverage it between the 6LN and the 6LR where the 6LR is a RPL router, as
   discussed in <xref target="LLN"/>. But as for <xref target="RFC8505"/> in
   general, this specification applies, beyond IoT use cases, to networks that
   are not necessarily LLNs, and/or where the routing protocol between the 6LR
   and above is not necessarily RPL. Examples of shared links and hub links are
   provided in <xref target="Shared"/> and <xref target="Hub"/>, respectively.
</t>
<section anchor="LLN"><name>LLN Mesh Network</name>
   <t>
   This specification also extends <xref target="RFC6550"/> and
   <xref target="RFC9010"/> in the case of a route-over multilink subnet based
   on the RPL routing protocol, to add multicast ingress replication in
   Non-Storing Mode and anycast support in both Storing and Non-Storing modes.
   A 6LR that implements the RPL extensions specified therein MUST also
   implement <xref target="RFC9010"/>.
   </t>
    <t>
    <xref target="figref"/> illustrates the classical situation of an LLN as a
    single IPv6 Subnet, with a 6LoWPAN Border Router (6LBR) that acts as Root
    for RPL operations and maintains a registry of the active registrations as
    an abstract data structure called an Address Registrar for 6LoWPAN ND.
    </t>

    <t>
	The LLN may be a hub-and-spoke access link such	as (Low-Power) Wi-Fi
    <xref target="IEEE80211"/> and Bluetooth (Low Energy)
    <xref target="IEEE802151"/>, or a Route-Over LLN such as the Wi-SUN and 6TiSCH meshes
    <xref target="I-D.heile-lpwan-wisun-overview"/> that leverages 6LoWPAN
    <xref target="RFC4919"/><xref target="RFC6282"/>
    and RPL <xref target="RFC6550"/> over <xref target="IEEE802154"/>.
    </t>

    <figure anchor="figref" align="center"><name>Wireless Mesh</name>
    <artwork><![CDATA[
                  |
      ----+-------+------------
          |     Wire side
       +------+
       | 6LBR |
       |(Root)|
       +------+
       o  o  o  Wireless side
   o   o o   o  o o
  o  o  o o   o  o  o
 o  o  o   LLN  o   +---+
   o  o   o  o   o  |6LR|
   o o  o o   o     +---+
    o   o   o o o  o    z
   o  o oo o  o        +---+
          o            |6LN|
                       +---+
    ]]></artwork></figure>


<t>
   A leaf acting as a 6LN registers its unicast, multicast, and anycast
   addresses a RPL router acting as a 6LR, using a layer-2 unicast NS message
   with an EARO as specified in <xref target="RFC8505"/> and <xref target=
   "I-D.ietf-6lo-multicast-registration"/>.
   The registration state is periodically renewed by the Registering Node,
   before the lifetime indicated in the EARO expires. As for unicast IPv6
   addresses, the 6LR uses an EDAR/EDAC exchange with the 6LBR to notify the
   6LBR of the presence of the listeners.
   With this specification, a router that own a prefix of provides reachability
   to an external prefix but is not a RPL router may also register those
   prefixes with the R flag set, to enable reachability via the RPL domain.
   As usual
</t>

</section><!--end section "LLN Mesh Network" -->


<section anchor="Shared"><name>Shared Link</name>

<t>
    A shared link is a situation where more than one Prefix is deployed over
    a L2 link (say a switched Ethernet + Wi-Fi ESS), and not necessarily all
    nodes are aware of all prefixes. <xref target="figshared"/> depicts such
    a situation, with 2 routers 6LR1 and 6LR2 that own respective prefixes P1::
    and P2::, and expose those in their RA messages over the same link.
</t>

    <figure anchor="figshared" align="center"><name>Shared Link</name>
    <artwork><![CDATA[

   +-----+   +-----+   +-----+   +-----+   +-----+
   |P1::c|   |P2::d|   |P2::e|   |P1::f|   |P1::g|
   +--+--+   +--+--+   +--+--+   +--+--+   +--+--+
      |         |         |         |         |
  ----+--+------+---------+--+------+---------+---+--
         |                  |                    |
     +---+---+          +---+---+
     | P1::a |          | P2::b |
     | 6LR1  |          | 6LR2  |
     +----+--+          +-------+
          |
         ....
        . . ..
          ...
    ]]></artwork></figure>
<t>
    Say that 6LR1 is the router providing access to the outside, and 6LR2 is
    aware of 6LR1 as its default gateway. With this specification, 6LR2
    registers P2:: to 6LR1 and 6LR1 installs a route to P2:: via 6LR2. This way,
    addresses that derive from P2:: can still be reached via 6LR1 and then 6LR2.
    6LR2 may then leverage ICMP Redirect messages <xref target="RFC4861"/> to
    shorten the path between 6LR1 and the nodes that own those addresses.
</t>
<t> If P2 was delegated by 6LR1, then the expectation is that 6LR1 aggregates
    P1:: and P2:: in its advertisements to the outside, and the is no need to
    set the R flag. But unless 6LR2 knows about such a situation, e.g., through
    configuration, it is probably safer for 6LR2 to set the R flag requesting
    6LR1 to advertise P2:: to the outside.
</t>
</section> <!-- end section "Shared Link" -->

<section anchor="Hub"><name>Hub Link</name>


<t>
    A hub link is a situation where stub links are deployed around a hub like and
    interconnected by routers. <xref target="fighub"/> depicts such
    a situation, with one router 6LR1 serving the hub link and at least one
    router like 6LR3 and 6LR3 providing connectivity from the stub links to the
    hub link. In this example, say that the there is one prefix on each link,
    P1:: on the hub link and P2::, P3::, etc. on the stub links.
</t>


    <figure anchor="fighub" align="center"><name>Hub and Stubs</name>
    <artwork><![CDATA[

   +-----+   +-----+   +-----+   +-----+   +-----+
   |P2::s|   |P2::d|   |P2::e|   |P2::f|   |P2::g|
   +--+--+   +--+--+   +--+--+   +--+--+   +--+--+
      |         |         |         |         |
  ----+----+----+---------+----STUB-+-LINK----+-----
           |
       +---+---+              +-------+       .
       | P2::r |              |       |     .. . .
       | 6LR2  |              | 6LR1  +--- .    . ..
       | P1::b |              | P1::a |    .     ...
       +---+---+              +---+---+      . ...
           |                      |
  -------+-+---------+--HUB-LINK--+-----+--
         |           |                |
     +---+---+    +--+--+          +--+--+
     | P1::c |    |P1::n|          |P1::q|
     | 6LR3  |    +-----+          +-----+
     | P3::m |
     +---+---+
         |
  ----+--+------+---------+----STUB-+-LINK----+-----
      |         |         |         |         |
   +--+--+   +--+--+   +--+--+   +--+--+   +--+--+
   |P3::h|   |P3::i|   |P3::j|   |P3::k|   |P3::a|
   +-----+   +-----+   +-----+   +-----+   +-----+

    ]]></artwork></figure>
<t>
    As before, say that 6LR1 is the router providing access to the outside, and
    6LR2 is aware of 6LR1 as its default gateway. With this specification, 6LR2
    registers P2:: to 6LR1 and 6LR1 installs a route to P2:: via 6LR2. This way,
    nodes on the stub link behind 6LR2 that derive their addresses from P2:: can
    still be reached via 6LR1 and then 6LR2. The same goes for 6LR3 and all other
    routers serving stub links.
</t><t>
    If P2 was delegated by 6LR1, then the expectation is that 6LR1 aggregates
    P1:: and P2:: in its advertisements to the outside, and the is no need to
    set the R flag. But unless 6LR2 knows about such a situation, e.g., through
    configuration, it is probably safer for 6LR2 to set the R flag requesting
    6LR1 to advertise P2:: to the outside.
</t>
</section> <!-- end section "Hub Link" -->
</section> <!-- end section "Overview" -->


   <section anchor="tgt4861"><name>Updating RFC 4861</name>
   <t>
   <xref target="RFC4861"/> expects that the NS/NA exchange is for a unicast
   address, which is indicated in the Target Address field of the ND message.
   This specification Amends <xref target="RFC4861"/> by allowing to advertise a
   prefix in the Target Address field when the NS or NA message is used for a
   registration, per section 5.5 of <xref target="RFC8505"/>; in that case, the
   prefix length is indicated in the EARO of the NS message, overloading the
   field that is used in the NA response for the Status.
    </t>
    </section ><!-- Updating RFC 4861 -->
    <section anchor="CIO"><name>Extending RFC 7400</name>

    <t>
   This specification Extends <xref target="RFC7400"> "6LoWPAN-GHC: Generic
   Header Compression for IPv6 over Low-Power Wireless Personal Area Networks
   (6LoWPANs)"</xref> by defining a new capability bit for use in the
   6CIO.  <xref target="RFC7400"/> was already extended by <xref target="RFC8505"/> for use in IPv6 ND messages.
    </t>
    <t>
   The new "Registration for prefixes Supported" (F) flag indicates
   to the 6LN that the 6LR accepts IPv6 prefix
   registrations as specified in this document and will ensure that packets
   for the addresses that match this prefix will be routed to the 6LNs that
   registered the prefix, and the route to the prefix will be redistributed if
   the R flag is set to 1.
    </t>
    <t>
   <xref target="fig6CIO"/> illustrates the F flag in its suggested position
   (7, counting 0 to 15 in network order in the 16-bit array), to be confirmed by IANA.
   </t>
   <figure anchor="fig6CIO"><name>New Capability Bit in the 6CIO</name>
   <artwork>
    <![CDATA[
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |   Length = 1  |   Reserved  |F|X|A|D|L|B|P|E|G|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Reserved                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    ]]></artwork>
    </figure>

    <t> New Option Field:    </t>
	<dl>
	<dt>X</dt><dd> 1-bit flag: "Registration for prefixes Supported" </dd>
	</dl>

    </section>	<!-- end section "Extending RFC 7400" -->




<section anchor="coex"><name>Updating RFC 6550</name>
<t>
   <xref target="RFC6550"/> uses the Path Sequence in the Transit Information
   Option (TIO) to retain only the freshest unicast route and remove stale ones,
   e.g., in the case of mobility. <xref target="RFC9010"/> copies the TID from
   the EARO into the Path Sequence, and the ROVR field into the associated RPL
   Target Option (RTO).
   This way, it is possible to identify both the registering node and the
   order of registration in RPL for each individual advertisement, so the
   most recent path and lifetime values are used.
</t><t>

   <xref target="I-D.ietf-6lo-multicast-registration"/> requires the use of the
   ROVR field as the indication of the origin of a Target advertisement in the
   RPL DAO messages, as specified in section 6.1 of <xref target="RFC9010"/>.
   For anycast and multicast advertisements (in NS or DAO messages), multiple
   origins may subscribe to the same address, in which case the multiple
   advertisements from the different or unknown origins are merged by the common
   parent; in that case, the common parent becomes the origin of the merged
   advertisements and uses its own ROVR value. On the other hand, a parent that
   propagates an advertisement from a single origin uses the original ROVR in
   the propagated RTO, as it does for unicast address advertisements, so the
   origin is recognized across multiple hops.

</t><t>
   This specification Extends <xref target="RFC6550"/> to require that,
   for prefix routes, the Path Sequence is used between and only between
   advertisements for the same Target and from the same origin (i.e, with the same ROVR value); in that case, only the freshest advertisement is retained. But the freshness comparison cannot apply if the
   origin is not determined (i.e., the origin did not support this specification).
</t><t>
   <xref target="RFC6550"/> uses the Path Lifetime in the TIO to indicate the
   remaining time for which the advertisement is valid for unicast route
   determination, and a Path Lifetime value of 0 invalidates that route.
   <xref target="RFC9010"/> maps the Address Registration lifetime in the EARO
   and the Path Lifetime in the TIO so they are comparable when both forms of
   advertisements are received.
</t><t>
   The RPL router that merges multiple advertisement for the same prefix must
   use and advertise the longest remaining lifetime
   across all the origins of the advertisements for that prefix.
   When the lifetime expires, the router sends a no-path DAO (i.e. the lifetime
   is 0) using the same value for ROVR value as for the previous advertisements,
   that is either self or the single descendant that advertised the Target.
</t><t>

   Note that the Registration Lifetime, TID and ROVR fields are also placed in
   the EDAR message so the state created by EDAR is also comparable with that created upon an NS(EARO) or a DAO message. For simplicity the text below
   mentions only NS(EARO) but applies also to EDAR.
</t>


</section>	<!-- end section "Updating RFC 6550" -->

<section anchor="updating"><name>Updating RFC 8505</name>




<section anchor="R8505EF"><name>New P field value</name>
<t> <xref target="I-D.ietf-6lo-multicast-registration"/> defines a P-field
   of 2 bits and defines the values 0 to 2, leaving the value of 3 reserved.
   This specification adds a new value to the P field to signal that the
   Registered Address is a prefix. The receiver should install a route to the
   prefix via the sender's address used as source address in the NS(EARO)
   registration message.

</t>
<t>

   This specification assigns the value of 3, resulting in the complete
   tabel as follows:

</t>
	 <table anchor="pVALS" ><name>P-field Values</name>
     <thead>
      <tr><td>Value</td><td>Meaning</td></tr>
     </thead><tbody>
      <tr><td>0</td><td>Registration for a Unicast Address</td></tr>
      <tr><td>1</td><td>Registration for a Multicast Address</td></tr>
      <tr><td>2</td><td>Registration for an Anycast Address</td></tr>
      <tr><td>3</td><td>Registration for a prefix</td></tr>
     </tbody>
    </table>  <!-- end table "P-field values" -->

</section><!-- New P field value -->

<section anchor="R8505E"><name>New EARO Prefix Length Field and F Flag</name>

<t>
   Section 4.1 of <xref target="RFC8505"/> defines the EARO as an extension to
   the ARO option defined in <xref target="RFC6775"/>.

</t>
<t>
  The Status Field that is used only when the EARO is placed in an NA message.
  This specification repurposes that field to carry the prefix length (plen)
  when the EARO is placed in an NS message as illustrated in <xref target="EARO"/>.
  The plen is expressed as 7 bits and the most significant bit of the field
  is reserved. A 7-bit value of 0 is understood as a truncated 128, meaning that
  this registration is for an address as opposed to a prefix.
  This approach is backward compatible with <xref target="RFC8505"/> and spans
  both addresses and prefixes.
  </t>

<t>
   This specification adds a new F flag to signal that the Registered Prefix
   is topologically correct through the Registering Node. This means that the
   Registering Node can relay packets that are sourced in the Registered Prefix
   to the outside, and the packets will be not be filtered by the application of
   <xref target="RFC2827"/>. The receiver should forward packets to the Registering Node
   address when the source address of the packets derives from the Registered Prefix.
   Note that to avoid loops, the receiver must be in the inside so packets
   sent by the sender towards the outside may never reach the receiver.
   The notion of inside and outside are administratively defined, e.g., inside
   is a particular Layer-2 network such as an Ethernet fabric.
</t>
<t>

   When the F flag is not set, the Registering Node owns the prefix and will
   deliver packets to the destination if the destination address derives
   from the prefix. Conversely, if the F flag is set, the Registering Node will
   forward traffic which source address derives from the Registered Prefix into
   a network location (e.g., to an ISP Provider Edge) where this source address
   is topologically correct (e.g., derives from a prefix assigned by that ISP).
   The F flag is encoded in the most significant bit of the EARO status field
   when the status field is used to transport a Prefix Length as shown in
   <xref target="EARO"/>.
</t>
 <figure anchor="EARO"><name>EARO Option Format in NS messages</name>
 <artwork align="center">
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |     Type      |     Length    |F|PrefixLength |    Opaque     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |   | P | I |R|T|     TID       |     Registration Lifetime     |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
 ...             Registration Ownership Verifier                 ...
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
 </figure><!-- end figure "EARO Option Format" -->

    <t> New and updated Option Fields:    </t>
    <dl>
    <dt>PrefixLength </dt><dd> 8-bit field: This field contains a prefix Length
    expressed in bits if the P field is set to 3 and the EARO is placed in an NS
    message. The field contains a Status if the EARO is placed in an NA message
    regardless of the setting of the P flag. In all other cases it is reserved,
    so it MUST be set to 0 by the sender and ignored by the receiver.</dd>
	<dt>F:</dt><dd> 1-bit flag; set to 1 to indicate that the sender expects
    other routers to forward packets to self when the packets are sourced with
    the registered prefix.</dd>
    </dl>

</section> <!-- end section "New EARO Prefix Length Field" -->

<section anchor="R8505D"><name>New EDAR Prefix Length Field</name>

<t>
   This specification adds the new value of 3 to the P field to signal that the
   Registered Address is a prefix. When that is the case, the prefix length is
   assumed to be less than 128 bits and the last 8 bits are dedicated to the
   prefix length.
</t>
<t>
   <xref target="EDAR"/> illustrates the EDAR message when the value of the
   P field is 3.
</t>
 <figure anchor="EDAR"><name>EDAR Message Format with P == 3</name>
 <artwork align="center">
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     Type      |CodePfx|CodeSfx|          Checksum             |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |P=3| Reserved  |     TID       |     Registration Lifetime     |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
...            Registration Ownership Verifier (ROVR)           ...
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                                                               |
 +                           Prefix                              +
 |                                                               |
 +                 (up to 128 bits, padded with 0s)              +
 |                                                               |
 +                                               +-+-+-+-+-+-+-+-+
 |                                               | Prefix Length |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</artwork>
 </figure><!-- end figure "EDAR Message Format with P == 3" -->

    <t> New and updated Option Fields:    </t>
	<dl>
	<dt>Reserved</dt><dd> 6-bit field: reserved, MUST be set to 0 and ignored by the receiver</dd>
	<dt>Prefix</dt><dd> 15 bytes: up to 128 bits of prefix, padded with 0s</dd>
	<dt>Prefix Length</dt><dd> 1-bit flag: length of the prefix, in bits</dd>
	</dl>

</section> <!-- end section "New EDAR Prefix Length Field" -->



<section anchor="multireg"><name>Registering Extensions</name>
<t>
   With <xref target="RFC8505"/>:
   </t>
<ul>
   <li>
   A router that expects to reboot may send a final RA message, upon which
   nodes should register elsewhere or redo the registration to the same router
   upon reboot.
   In all other cases, a node reboot is silent.
   When the node comes back to life, existing registration
   state might be lost if it was not persisted, e.g., in persistent memory.
   </li>
   <li>
   Only unicast addresses can be registered.
   </li>
   <li>
   The 6LN must register all its ULA and GUA with a NS(EARO).
   </li>
   <li>
   The 6LN may set the R flag in the EARO to obtain return reachability services by the 6LR, e.g., through ND proxy operations, or by injecting the route in a route-over subnet.
   </li>
   <li>
   the 6LR maintains a registration state per Registered Address, including an
   NCE with the Link Layer Address (LLA) of the Registered Node (the 6LN here).
   </li>
   </ul>

  <t>
   This specification adds the following behavior, similar to that introduced
   by <xref target="I-D.ietf-6lo-multicast-registration"/> for multicast addresses:
  </t>
   <ul>
   <li>
   The operation for registering prefixes is similar as for addresses from the
   perspective of the 6LN, but show important differences on the router side,
   which maintains a separate state for each origin and merges them in its own
   advertisements.
   </li>
   <li>
   <t>
   The ARO Status indicating a "Registration Refresh Request" applies to prefixes
   as well.
   </t>
   <t>
   This status is used in asynchronous NA(EARO) messages to indicate to peer 6LNs
   that they are requested to reregister all addresses and prefixes that were
   previously registered to the originating node. The NA message may be sent to
   a unicast or a multicast link-scope address and should be contained within
   the L2 range where nodes may effectively have registered/subscribed to this
   router, e.g., a radio broadcast domain.
   </t>
   <t>
   A device that wishes to refresh its state, e.g., upon reboot if it may have
   lost some registration state, SHOULD send an asynchronous NA(EARO) with this
   new status value. That asynchronous NA(ARO) SHOULD be sent to the all-nodes
   link scope multicast address (FF02::1) and Target MUST be set to the link
   local address that was exposed previously by this node to accept registrations,
   and the TID MUST be set to 0.
   </t>
   <t>
   In an unreliable environment, the multicast NA(EARO) message may be resent in
   a fast sequence, in which case the TID must be incremented each time.
   A 6LN that has recently
   processed the NA(ARO) ignores the NA(EARO) with a newer TID received
   within the duration of the fast sequence. That duration depends on the
   environent and has to be configured. By default, it is of 10 seconds.
   </t>
   </li>
   <li>
   <t>
   Registration for prefixes is now supported. The value of 3 in the P field of
   the EARO and the EDAR message signals when the registration is for a prefix
   as opposed to an address. DAD for prefixes and addresses becomes a prefix
   overlap match. Whether overlapping addresses and prefixes may be registered
   is a network policy decision and out of scope.
   The same prefix may be injected twice (multiple routes) as long as they use
   the same value of the ROVR.
   </t>
   <t>
   Overlaps may be desirable. It may happen for instance that a proxy
   registers a prefix while a host using an address from that prefix also
   registers.
   It might also occur that an aggregated prefix is owned as a catch all, and
   subdivised into subnets that are allocated to and then registered by other
   nodes.
   </t>
   <t>
   In case of an overlapping registration, the longest match wins, meaning that
   if the  network policy allows for overlapping registrations, then the
   registration the routes are installed towards the node that registered with
   the longest match, all the way to /128.
   </t>
   </li>
   <li>
   If the 6LR acts as a router to prefixes or owns the prefixes entirely, it
   SHOULD register all those prefixes on all interface from which it might be needed to relay traffic to that prefix, and it MUST set the P field in the
   EARO to 3 for those prefixes.
   </li>
   <li>
   The 6LN MAY set the R flag in the EARO to request the 6LR to redistribute
   the prefix on other links using a routing protocol. The 6LR MUST NOT
   reregister that prefix to yet another router as it may create a loop.
   </li>
   <li>
   The 6LR and the 6LBR are extended to accept more than one registration for
   the same prefix, since multiple 6LNs may register it. The Registration
   Ownership Verifier (ROVR) in the EARO identifies uniquely a registration
   within the namespace of the Registered Prefix.
   </li>
   <li>
    The 6LR MUST maintain a registration state per tuple (IPv6 prefix/length, ROVR)
    for all registered prefix. It SHOULD notify the 6LBR
    with an EDAR message, unless it determined that the 6LBR is legacy and does
	not support this specification (see <xref target="CIO"/>). In turn, the 6LBR MUST maintain a
    registration state per tuple (IPv6 prefix, ROVR) for all prefixes.
   </li>

   </ul>

</section> <!-- end section "Registering Extensions"-->

</section> <!-- end section "Updating RFC 8505"-->


<section anchor="updating2"><name>Updating RFC 9010</name>
<t>
   With <xref target="RFC9010"/>:
   </t>
   <ul>
   <li>
   The 6LR injects only unicast routes in RPL
   </li>
   <li>
   Upon a registration with the R flag set to 1 in the EARO, the 6LR injects the address in the RPL unicast support.
   </li><li>
   Upon receiving a packet directed to a unicast address for which it has an
   active registration, the 6LR delivers the packet as a unicast layer-2 frame
   to the LLA the nodes that registered the unicast address.
   </li>
   </ul>
   <t>
   This specification adds the following behavior:
   </t>
   <ul>
   <li>
   Upon a registration with the R flag set to 1 and the P field set to 3 in the EARO, the 6LR injects the prefix in RPL using a prefix RTO.
   The P field in the RTP MUST be set to 3.
   </li><li>

   </li><li>
   Upon receiving a packet directed to an address that derives from a prefix for
   which it has at least one registration, the 6LR delivers a copy of the packet
   as a unicast layer-2 frame to the LLA of exactly one of the nodes that
   registered to that prefix, using the longest match derivation to find the
   best 6LN.
   </li>
   </ul>


</section> <!-- end section "Updating RFC 9010"-->


<section  anchor="sec8928"><name>Updating RFC 8928</name>
<t>
    <xref target="RFC8928"> Address-Protected Neighbor Discovery for
    Low-Power and Lossy Networks </xref> was defined to protect the ownership of unicast IPv6 addresses that are registered with
    <xref target="RFC8505"/>.

</t>
<t>
    With <xref target="RFC8928"/>, it is possible for a node to autoconfigure a
    pair of public and private keys and use them to sign the registration of
    addresses that are either autoconfigured or obtained through other methods.

</t>
<t>
    The first hop router (the 6LR) may then validate a registration and
    perform source address validation on packets coming from the sender node
    (the 6LN).

</t>
<t>
    Prefixes are not always owned by one node. Multiple nodes
    may register the same prefix.
    In that context, the method specified in <xref target="RFC8928"/> cannot be
    used with node-local autoconfigured keypairs which protect a single ownership
    only.
</t>
<t>
    For a prefix, as for an anycast or a multicast address, it is still possible
    to leverage <xref target="RFC8928"/> to enforce the right to register.
    If <xref target="RFC8928"/> is used, a keypair MUST be created and
    associated with the prefix before the prefix is deployed, and a ROVR MUST be
    generated from that keypair as specified in <xref target="RFC8928"/>.
    The prefix and the ROVR MUST then be installed in the 6LBR at the first
    registration, or by an external mechanism such as IPAM or DHCPv6 snooping
    prior to the first registration. This way, the 6LBR can recognize the prefix
    on the future registrations and validate the right to register based on the
    ROVR.
</t>
<t>
    The keypair MUST then be provisioned in each node that needs to
    register the prefix or a prefix within, so the node can follow the
    steps in <xref target="RFC8928"/> to register the prefix.
</t>
<t>
    Upon a NA Message with the status set to 5 "Validation Requested", the
    node that registered addresses or prefixes with use the longest matching
    address or prefix and perform the proof of ownership based on that
    longest match.
</t>
</section>  <!-- Leveraging RFC 8929 -->



<section  anchor="sec"><name>Security Considerations</name>
<t>
    This specification extends <xref target="RFC8505"/>, and
    the security section of that document also applies to this document.
    In particular, the link layer SHOULD be sufficiently
    protected to prevent rogue access.
</t>
<t>
   <xref target="sec8928"/> leverages <xref target="RFC8928"/> to prevent an
   rogue node to register a unicast address that it does not own.
   The mechanism could be extended to anycast and multicast addresses if the
   values of the ROVR they use is known in advance, but how this is done is
   not in scope for this specification.
   One way would be to authorize in a advance the ROVR of the valid users.
   A less preferred way could be to synchronize the ROVR and TID values across
   the valid registering nodes as a preshared key material.
</t>
<t>
   In the latter case, it could be possible to update the keys associated to
   a prefix in all the 6LNs, but the flow is not clearly documented and may
   not complete in due time for all nodes in LLN use cases. It may be simpler
   to install a all-new address with new keys over a period of time, and
   switch the traffic to that address when the migration is complete.
</t>
</section>	<!-- end section "Security Considerations" -->

<section anchor="back"><name>Backward Compatibility</name>
<t>
   A legacy 6LN will not register prefixess and the service will be
   the same when the network is upgraded. A legacy 6LR will not set the F flag
   in the 6CIO and an upgraded 6LN will not register prefixes.
</t>
<t>
   Upon an EDAR message, a legacy 6LBR may not realize that the address being
   registered is anycast or multicast, and return that it is duplicate in the
   EDAC status. The 6LR MUST ignore a duplicate status in the EDAR for anycast
   and multicast addresses.
</t>

</section>	<!-- end section "Backward Compatibility" -->

<section ><name>IANA Considerations</name>
<t>
    Note to RFC Editor, to be removed: please replace "This RFC" throughout this
    document by the RFC number for this specification once it is allocated.
    Also, the I Field is defined in <xref target="RFC9010"/> but is missing from
    the registry, so the bit positions must be added for completeness.
</t>
<t>
    IANA is requested to make changes under the "Internet Control Message
    Protocol version 6 (ICMPv6) Parameters" <xref target="IANA.ICMP"/> and the
    "Routing Protocol for Low Power and Lossy Networks (RPL)" <xref target="IANA.RPL"/>
    registry groupings, as follows:
</t>


    <section anchor="PF"><name>Updated P-Field Registry</name>

	<t>
    This specification updates the P field introduced in <xref target=
    "I-D.ietf-6lo-multicast-registration"/> to assign the value of 3, which is
    the only remaining unasssigned value for the 2-bits field. To that effect,
    IANA is requested to update the "P-field values" registry under the
    heading "Internet Control Message Protocol version 6 (ICMPv6) Parameters"
    as indicated in <xref target="AM2"/>:
	</t>

	 <table anchor="AM2" ><name>New P-field value</name>
     <thead>
      <tr><td>Value</td><td>Meaning</td><td>Reference</td></tr>
     </thead><tbody>
      <tr><td>3</td><td>Registration for a prefix</td><td>This RFC</td></tr>
     </tbody>
    </table>  <!-- end table "New P-field values" -->

    </section><!-- end section "Updated P-Field Registry" -->


<!--
    <section anchor="AROF">
    <name>New Extended Address Registration Option Flag</name>
	<t>
    IANA is requested to make an addition to the
    "Address Registration Option Flags" <xref target="IANA.ICMP.EARO"/> registry under the
    heading "Internet Control Message Protocol version 6 (ICMPv6) Parameters"
    as indicated in <xref target="AROdat"/>:
	</t>

	<table anchor="AROdat" ><name>New Extended Address Registration Option Flag</name>
   <thead>
      <tr><td>EARO Bit</td><td>Meaning</td><td>Reference</td></tr>
   </thead><tbody>
      <tr><td>1 (suggested)</td><td>F flag: prefix is topologically correct</td><td>This RFC</td></tr>

   </tbody>
	</table>
    </section>	 end section "New Address Registration Option Flag" -->



    <section anchor="CIOF">   <name>New 6LoWPAN Capability Bit</name>
	<t>
    IANA is requested to make an addition to the
    "6LoWPAN Capability Bits" <xref target="IANA.ICMP.6CIO"/> registry under the
    heading "Internet Control Message Protocol version 6 (ICMPv6) Parameters"
    as indicated in <xref target="CIOdat"/>:
	</t>

	<table anchor="CIOdat" ><name>New 6LoWPAN Capability Bit</name>
   <thead>
      <tr><td>Capability Bit</td><td>Meaning</td><td>Reference</td></tr>
   </thead><tbody>
      <tr><td>7 (suggested)</td><td>F flag: Registration for prefixes Supported (F)</td><td>This RFC</td></tr>

   </tbody>
	</table>	<!-- end table "New 6LoWPAN Capability Bit" -->
    </section>	<!-- end section "New 6LoWPAN Capability Bit" -->




</section>	<!-- end section "IANA Considerations" -->

<section title="Acknowledgments">
<t>
MAny thanks to Dave Thaler for his early INT-DIR review.
</t>
</section> <!-- title="Acknowledgments" -->







</middle>

<back>

   <displayreference   target="RFC2827"    to="BCP38"/>

    <references title="Normative References">
	<!-- RFC  -->

	<xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"/>
    <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.4861.xml"/>
	<xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.4862.xml"/>
	<xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6550.xml"/>
	<xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6775.xml"/>
	<xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7400.xml"/>
	<xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"/>
	<xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8200.xml"/>
	<xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8505.xml"/>

    <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8928.xml"/>

    <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.9010.xml"/>

	   <reference anchor="IANA.ICMP">
		<front>
			<title>IANA Registry for ICMPv6</title>
			<author>
				<organization>
					IANA
				</organization>
			</author>
			<date year=""></date>
		</front>
		<seriesInfo name="IANA," value="https://www.iana.org/assignments/icmpv6-parameters/icmpv6-parameters.xhtml"></seriesInfo>
	   </reference>

       <reference anchor="IANA.ICMP.6CIO">
       <front>
			<title>IANA Registry for the 6LoWPAN Capability Bits</title>
			<author>
				<organization>
					IANA
				</organization>
			</author>
			<date year=""></date>
		</front>
		<seriesInfo name="IANA," value="https://www.iana.org/assignments/icmpv6-parameters/icmpv6-parameters.xhtml#sixlowpan-capability-bits"></seriesInfo>
	   </reference>
       <!--reference anchor="IANA.ICMP.EARO">
       <front>
			<title>IANA Registry for the Address Registration Option Flags</title>
			<author>
				<organization>
					IANA
				</organization>
			</author>
			<date year=""></date>
		</front>
		<seriesInfo name="IANA," value="https://www.iana.org/assignments/icmpv6-parameters/icmpv6-parameters.xhtml#icmpv6-adress-registration-option-flags"></seriesInfo>
	   </reference-->


	   <reference  anchor="IANA.RPL">
       <front>
			<title>IANA Registry for the RPL</title>
			<author>
				<organization>
					IANA
				</organization>
			</author>
			<date year=""></date>
		</front>
		<seriesInfo name="IANA," value="https://www.iana.org/assignments/rpl/rpl.xhtml"></seriesInfo>
	   </reference>




    </references>


    <references title="Informative References">
	<!-- RFC  -->

    <!-- I-D -->

    <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2827.xml"/>
    <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.4919.xml"/>
    <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6282.xml"/>
    <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.9008.xml"/>
    <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-6lo-multicast-registration.xml"/>


      <xi:include href='https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.kuehlewind-update-tag.xml'/>
    <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.heile-lpwan-wisun-overview.xml"/>
    <xi:include href="https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-6man-ipv6-over-wireless.xml"/>
      <reference anchor="IEEE802154">
         <front>
            <title>IEEE Std 802.15.4, Part. 15.4: Wireless Medium Access
            Control (MAC) and Physical Layer (PHY) Specifications for Low-Rate
            Wireless Personal Area Networks
            </title>
            <author>
               <organization>IEEE standard for Information Technology</organization>
            </author>
            <date/>
         </front>
      </reference>

      <reference anchor="IEEE80211"
                 target="https://ieeexplore.ieee.org/document/9363693" >
        <front>
          <title>
            IEEE Standard 802.11 - IEEE Standard for Information
            Technology - Telecommunications and information exchange
            between systems Local and metropolitan area networks -
            Specific requirements - Part 11: Wireless LAN Medium
            Access Control (MAC) and Physical Layer (PHY)
            Specifications.
          </title>
          <author>
               <organization>IEEE standard for Information Technology</organization>
           </author>
          <date/>
        </front>
      </reference>


      <reference anchor="IEEE802151">
         <front>
            <title> IEEE Standard for Information Technology -
		Telecommunications and Information Exchange Between Systems -
		Local and Metropolitan Area Networks - Specific Requirements. -
		Part 15.1: Wireless Medium Access Control (MAC) and Physical
		Layer (PHY) Specifications for Wireless Personal Area Networks
		(WPANs)
            </title>
            <author>
            	<organization> IEEE standard for Information Technology
		</organization>
            </author>
            <date/>
         </front>
      </reference>

    </references>

</back>

</rfc>
